<script>
  document.querySelector('form').addEventListener('submit', function(event) {
    event.preventDefault();  // Prevent form submission

    var fileInput = document.querySelector('input[type="file"]');
    var file = fileInput.files[0];

    var progressBar = document.getElementById('progress-bar-fill');
    var submitButton = document.querySelector('input[type="submit"]');

    var xhr = new XMLHttpRequest();
    xhr.open('POST', '{{ url_for('insert_spdx') }}', true);

    // Progress event listener
    xhr.upload.onprogress = function(event) {
      if (event.lengthComputable) {
        var progress = (event.loaded / event.total) * 100;
        progressBar.style.width = progress + '%';
        progressBar.textContent = progress.toFixed(2) + '% Complete';
      }
    };

    // Completion event listener
    xhr.onload = function() {
      if (xhr.status === 200) {
        // File upload success
        console.log('File uploaded successfully!');
      } else {
        // File upload error
        console.error('Error uploading file.');
      }

      // Re-enable the submit button
      submitButton.disabled = false;
    };

    // Disable the submit button during upload
    submitButton.disabled = true;

    // Send the file
    var formData = new FormData();
    formData.append('file', file);
    xhr.send(formData);
  });
</script>

